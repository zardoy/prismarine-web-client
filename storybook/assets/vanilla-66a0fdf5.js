const T=Symbol(),K=Object.getPrototypeOf,V=new WeakMap,Y=n=>n&&(V.has(n)?V.get(n):K(n)===Object.prototype||K(n)===Array.prototype),q=n=>Y(n)&&n[T]||null,z=(n,y=!0)=>{V.set(n,y)},B=n=>typeof n=="object"&&n!==null,E=new WeakMap,L=new WeakSet,F=(n=Object.is,y=(t,u)=>new Proxy(t,u),g=t=>B(t)&&!L.has(t)&&(Array.isArray(t)||!(Symbol.iterator in t))&&!(t instanceof WeakMap)&&!(t instanceof WeakSet)&&!(t instanceof Error)&&!(t instanceof Number)&&!(t instanceof Date)&&!(t instanceof String)&&!(t instanceof RegExp)&&!(t instanceof ArrayBuffer),j=t=>{switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:throw t}},w=new WeakMap,R=(t,u,d=j)=>{const c=w.get(t);if((c==null?void 0:c[0])===u)return c[1];const f=Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t));return z(f,!0),w.set(t,[u,f]),Reflect.ownKeys(t).forEach(S=>{if(Object.getOwnPropertyDescriptor(f,S))return;const l=Reflect.get(t,S),h={value:l,enumerable:!0,configurable:!0};if(L.has(l))z(l,!1);else if(l instanceof Promise)delete h.value,h.get=()=>d(l);else if(E.has(l)){const[i,M]=E.get(l);h.value=R(i,M(),d)}Object.defineProperty(f,S,h)}),Object.preventExtensions(f)},p=new WeakMap,a=[1,1],m=t=>{if(!B(t))throw new Error("object required");const u=p.get(t);if(u)return u;let d=a[0];const c=new Set,f=(r,s=++a[0])=>{d!==s&&(d=s,c.forEach(e=>e(r,s)))};let S=a[1];const l=(r=++a[1])=>(S!==r&&!c.size&&(S=r,i.forEach(([s])=>{const e=s[1](r);e>d&&(d=e)})),d),h=r=>(s,e)=>{const o=[...s];o[1]=[r,...o[1]],f(o,e)},i=new Map,M=(r,s)=>{if(c.size){const e=s[3](h(r));i.set(r,[s,e])}else i.set(r,[s])},W=r=>{var s;const e=i.get(r);e&&(i.delete(r),(s=e[1])==null||s.call(e))},U=r=>(c.add(r),c.size===1&&i.forEach(([e,o],P)=>{const b=e[3](h(P));i.set(P,[e,b])}),()=>{c.delete(r),c.size===0&&i.forEach(([e,o],P)=>{o&&(o(),i.set(P,[e]))})}),v=Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t)),A=y(v,{deleteProperty(r,s){const e=Reflect.get(r,s);W(s);const o=Reflect.deleteProperty(r,s);return o&&f(["delete",[s],e]),o},set(r,s,e,o){const P=Reflect.has(r,s),b=Reflect.get(r,s,o);if(P&&(n(b,e)||p.has(e)&&n(b,p.get(e))))return!0;W(s),B(e)&&(e=q(e)||e);let D=e;if(e instanceof Promise)e.then(O=>{e.status="fulfilled",e.value=O,f(["resolve",[s],O])}).catch(O=>{e.status="rejected",e.reason=O,f(["reject",[s],O])});else{!E.has(e)&&g(e)&&(D=m(e));const O=!L.has(D)&&E.get(D);O&&M(s,O)}return Reflect.set(r,s,D,o),f(["set",[s],e,b]),!0}});p.set(t,A);const _=[v,l,R,U];return E.set(A,_),Reflect.ownKeys(t).forEach(r=>{const s=Object.getOwnPropertyDescriptor(t,r);"value"in s&&(A[r]=t[r],delete s.value,delete s.writable),Object.defineProperty(v,r,s)}),A})=>[m,E,L,n,y,g,j,w,R,p,a],[N]=F();function G(n={}){return N(n)}function J(n,y,g){const j=E.get(n);let w;const R=[],p=j[3];let a=!1;const t=p(u=>{if(R.push(u),g){y(R.splice(0));return}w||(w=Promise.resolve().then(()=>{w=void 0,a&&y(R.splice(0))}))});return a=!0,()=>{a=!1,t()}}export{G as p,J as s};
//# sourceMappingURL=vanilla-66a0fdf5.js.map
